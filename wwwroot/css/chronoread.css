/* 1. 模拟的网页内容 (居中) */
.page-content {
    position: relative;
    max-width: 720px; /* 舒适的阅读宽度 */
    margin: 0 auto;
    background: #ffffff;
    padding: 3rem 4rem;
    border-radius: 0.75rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.05), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
}

    .page-content h1 {
        font-size: 2.25rem;
        font-weight: 700;
        margin-bottom: 1.5rem;
    }

    .page-content p {
        font-size: 1.125rem;
        line-height: 1.8;
        margin-bottom: 1.5rem;
        position: relative;
    }

/* 新增：原文下划线标记 */
.chrono-anchor-text {
    /* 使用虚线/点状下划线 */
    border-bottom: 2px dotted #3b82f6; /* 蓝色 (AI) */
    padding-bottom: 1px;
}

    .chrono-anchor-text.user {
        border-bottom-color: #16a34a; /* 绿色 (User) */
    }


/* 2. 原文标记 (小圆点) */
.node-marker {
    position: absolute;
    width: 0.75rem; /* 12px - 改小为实心圆点 */
    height: 0.75rem; /* 12px - 改小为实心圆点 */
    border-radius: 50%;
    /* border: 3px solid white; - 移除边框 */
    box-shadow: 0 1px 3px rgba(0,0,0,0.2);
    cursor: pointer;
    z-index: 20;
    transition: all 0.2s;
    /* 由 JS 设定 top */
    /* 关键：定位到左侧空白边缘 (padding区) */
    left: 1.75rem;
    /* transform: translateX(-3.5rem); - 移除 */
}

    .node-marker:hover {
        /* transform: translateX(-3.5rem) scale(1.2); - 移除 */
        transform: scale(1.2); /* 简单的缩放效果 */
    }

    .node-marker.ai {
        background-color: #3b82f6;
    }

    /* 关键：用户圆点定位到右侧 */
    .node-marker.user {
        background-color: #16a34a;
        left: auto; /* 覆盖 ai 的 left */
        right: 1.75rem; /* 定位到右侧空白边缘 (padding区) */
    }

    .node-marker.active {
        /* 激活状态的边框 - 简化为光环 */
        box-shadow: 0 0 0 5px rgba(59, 130, 246, 0.3); /* 蓝色光环 */
    }

    .node-marker.user.active {
        /* 绿色光环 */
        box-shadow: 0 0 0 5px rgba(22, 163, 74, 0.3);
    }

/* 3. 双轨时间线卡片 (左右伴随) */
.timeline-card {
    position: absolute;
    width: 300px;
    border-radius: 0.75rem;
    background-color: white;
    z-index: 10;
    /* 关键：默认隐藏，由 JS .visible 类控制 */
    opacity: 0;
    pointer-events: none;
    visibility: hidden;
    transition: opacity 0.3s, transform 0.3s, top 0.3s, box-shadow 0.3s;
}

    .timeline-card.visible {
        opacity: 1;
        pointer-events: auto;
        visibility: visible;
    }
    /* 用于碰撞处理 */
    .timeline-card.hidden-by-expansion {
        opacity: 0 !important;
        transform: scale(0.95) !important;
        pointer-events: none !important;
    }

    .timeline-card.ai {
        border: 1px solid #dbeafe;
        box-shadow: 0 4px 6px rgba(0,0,0,0.03);
        left: 0;
        transform: translateX(calc(-100% - 2.5rem));
    }

        .timeline-card.ai.visible:hover {
            transform: translateX(calc(-100% - 2.5rem)) translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.05);
        }

    .timeline-card.user {
        border: 1px solid #dcfce7;
        box-shadow: 0 4px 6px rgba(0,0,0,0.03);
        right: 0;
        transform: translateX(calc(100% + 2.5rem));
    }

        .timeline-card.user.visible:hover {
            transform: translateX(calc(100% + 2.5rem)) translateY(-2px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.05);
        }

/* 卡片摘要 (可点击) */
.card-summary {
    padding: 0.875rem 1.125rem;
    cursor: pointer;
}

    .card-summary blockquote {
        font-size: 0.875rem;
        color: #6b7280;
        border-left: 3px solid #9ca3af;
        padding-left: 0.75rem;
        margin-bottom: 0.5rem;
        font-style: italic;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2; /* 摘要只显示2行 */
        -webkit-box-orient: vertical;
    }

    .card-summary p {
        font-size: 1rem;
        line-height: 1.6;
        color: #374151;
        margin-bottom: 0;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 3; /* 摘要只显示3行 */
        -webkit-box-orient: vertical;
    }

/* 4. 卡片展开区域 (聊天) */
.card-expansion {
    /* 关键：平滑展开动画 */
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.4s ease-out, padding 0.4s ease-out;
}

.timeline-card.expanded .card-expansion {
    border-top: 1px solid #f3f4f6;
    max-height: 500px; /* 展开后的高度 */
    padding-top: 0.75rem;
    padding-bottom: 0.75rem;
}
/* 展开时卡片阴影变大 */
.timeline-card.expanded {
    box-shadow: 0 10px 25px rgba(0,0,0,0.1);
    z-index: 15; /* 确保展开的卡片在最上层 */
}

.chat-history { /* 重命名自 #modal-chat-history */
    display: flex;
    flex-direction: column;
    padding: 0 0.75rem;
    max-height: 300px;
    overflow-y: auto;
    space-y: 0.75rem;
}

.chat-bubble {
    padding: 0.75rem 1rem;
    border-radius: 0.75rem;
    margin-bottom: 0.75rem;
    max-width: 90%;
    line-height: 1.6;
}

    .chat-bubble.rag-question {
        background-color: #e0e7ff;
        color: #3730a3;
        align-self: flex-end;
        margin-left: 10%;
    }

    .chat-bubble.rag-answer {
        background-color: #f3f4f6;
        color: #374151;
        align-self: flex-start;
        margin-right: 10%;
    }

.chat-input-wrapper {
    padding: 0.75rem 0.75rem 0;
}

.ask-input {
    display: flex;
    border: 1px solid #e5e7eb;
    border-radius: 0.75rem;
}

    .ask-input input {
        flex: 1;
        border: none;
        padding: 0.75rem 1rem;
        background: transparent;
        border-radius: 0.75rem 0 0 0.75rem;
        font-size: 0.875rem;
    }

        .ask-input input:focus {
            outline: none;
            ring: 0;
        }

    .ask-input button {
        background-color: #3b82f6;
        color: white;
        border: none;
        padding: 0 1rem;
        border-radius: 0 0.75rem 0.75rem 0;
        cursor: pointer;
    }

        .ask-input button:hover {
            background-color: #2563eb;
        }

/* 5. 划词菜单 (Selection Menu) */
#selection-menu {
    position: absolute;
    background-color: #262626;
    color: white;
    border-radius: 0.5rem;
    cursor: pointer;
    box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    font-size: 0.875rem;
    font-weight: 500;
    z-index: 100;
    overflow: hidden;
}

.menu-button {
    padding: 0.625rem 0.875rem;
    display: flex;
    align-items: center;
    gap: 0.375rem;
    transition: background-color 0.2s;
}

    .menu-button:hover {
        background-color: #404040;
    }

    .menu-button.disabled {
        background-color: #262626 !important; /* 保持暗色背景 */
        opacity: 0.5; /* 变灰 */
        cursor: not-allowed; /* 显示不可点击光标 */
    }

    .menu-button:not(:last-child) {
        border-right: 1px solid #525252;
    }

    .menu-button svg {
        width: 1rem;
        height: 1rem;
    }
